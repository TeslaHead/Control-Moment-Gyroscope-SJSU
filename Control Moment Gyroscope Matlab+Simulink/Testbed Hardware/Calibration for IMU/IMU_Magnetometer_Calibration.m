%% -------  [Calibration for Magnetometer Scaling]  ------- %%
clc; clear all; close all;
% By: Jason Nguyen

%% --------------  [Raw Magnetometer Data]  -------------- %%

C = [-14.7	17.7	6.3
-15.15	18	7.05
-15.3	3	11.4
-16.8	-26.7	6.6
-16.95	-27.75	6.3
-15.3	-40.05	-1.05
-16.2	-46.35	-8.25
-18	-45.45	-9.45
-16.65	-51.9	-25.2
-15.45	-52.65	-25.8
-16.2	-51.45	-34.65
-16.5	-52.8	-33.75
-14.55	-49.8	-50.7
-16.65	-42.9	-58.65
-16.95	-42.15	-58.2
-16.95	-32.85	-66.3
-16.2	-44.1	-58.65
-13.2	-48.75	-50.85
-12	-49.8	-43.05
-12.15	-53.1	-34.65
-10.95	-51.9	-32.85
-13.05	-51.6	-30.15
-13.65	-24.6	-70.35
-13.8	-23.25	-70.95
-15.3	-11.55	-73.95
-15	-4.95	-73.5
-15.9	2.1	-73.65
-15.15	0.45	-72.9
-14.55	2.25	-73.2
-17.4	11.85	-71.55
-16.05	12	-70.95
-16.5	21.75	-65.1
-18	26.4	-62.1
-16.65	26.55	-58.65
-17.7	26.55	-61.95
-15.9	30.15	-54.9
-14.7	38.7	-36.9
-13.95	37.5	-35.85
-15	39.6	-24.9
-13.65	35.1	-9.3
-14.55	33.75	-10.2
-15	27.9	-1.35
-14.25	33.75	-7.95
-15.75	28.35	-0.6
-14.55	19.05	6.15
-15.45	18.45	6
-14.55	18.15	5.4
-8.25	18.6	3.9
-7.05	17.85	5.1
-7.65	16.8	5.7
4.05	18.6	-3.9
4.05	18.6	-3.6
-12.45	18	5.7
-7.2	17.25	5.25
1.2	18.75	-0.15
7.5	18.6	-6.6
6.3	18.6	-6.15
6.3	19.05	-6.15
12.45	19.5	-16.65
14.55	17.1	-30.45
15.9	17.7	-30.6
15	17.85	-31.2
12.9	18	-22.2
14.7	16.05	-22.5
11.7	17.25	-14.1
9	16.65	-9.45
9.45	18.45	-10.35
6.45	19.2	-6.75
5.4	18.45	-2.7
4.2	18.45	-3.75
2.25	17.1	-1.8
1.5	18.15	-0.6
-0.45	16.5	0.9
-3.3	17.1	3.6
15.9	17.7	-36.15
9.45	16.8	-50.85
15.45	12.9	-43.2
14.25	16.2	-44.85
13.8	16.65	-46.65
13.5	16.65	-48.15
10.8	15.15	-50.7
9	15.45	-55.05
8.4	15.3	-54.6
5.55	16.65	-58.5
5.25	15.45	-58.05
3.45	14.55	-59.7
4.2	15.75	-60.75
-2.4	14.1	-64.2
-3.9	14.1	-65.55
-4.2	13.35	-67.8
-6.3	13.95	-65.85
-7.05	13.95	-67.65
-11.55	17.1	-67.95
-13.95	14.85	-67.05
-11.4	16.05	-68.55
-13.65	17.25	-67.5
-15.45	16.05	-68.25
-15.15	15.3	-68.25
-16.5	15.9	-69.15
-21.3	13.95	-70.2
-20.25	14.7	-69.15
-21.3	13.95	-70.2
-21.15	13.8	-70.05
-24.45	14.55	-70.8
-25.65	14.85	-72.3
-28.8	14.7	-70.65
-30.75	12.75	-69.15
-28.8	11.55	-70.65
-33.75	12	-67.65
-33.9	11.4	-68.55
-38.55	13.5	-65.85
-35.7	12.9	-68.25
-42.15	12.6	-63.75
-43.5	12.45	-64.35
-42	11.25	-63.9
-43.2	11.4	-64.8
-50.55	11.25	-60.6
-54.3	11.55	-52.5
-54.9	14.85	-51.3
-56.7	14.1	-44.7
-58.5	14.25	-43.05
-58.65	14.85	-39.15
-59.25	14.25	-37.5
-58.8	14.25	-36.75
-57	14.25	-39.3
-58.8	14.25	-33.45
-58.05	15.15	-24.6
-57.75	15.45	-24.15
-58.95	14.85	-26.55
-60.15	16.05	-26.55
-57.9	15.3	-25.5
-57.75	15.9	-25.35
-58.5	15.45	-20.1
-56.25	15.15	-16.5
-55.65	16.8	-14.85
-52.65	16.05	-13.35
-53.4	16.5	-11.1
-51.75	17.4	-9.45
-51.9	15.75	-8.55
-49.8	14.7	-8.4
-48.15	16.8	-4.95
-47.7	16.5	-6
-45.45	16.05	-4.2
-46.5	17.1	-3.9
-46.95	17.25	-4.5
-43.2	15.3	-2.25
-41.4	16.05	-0.9
-40.05	15.9	0
-39	17.85	2.1
-39	16.65	2.85
-34.65	16.8	2.25
-35.55	17.1	1.8
-32.55	15.45	3.9
-32.25	17.85	3.6
-28.05	17.1	5.85
-25.2	17.7	6
-23.55	17.4	6.15
-23.4	16.05	4.5
-20.25	17.4	5.4
-18.45	17.7	4.95
-16.2	17.25	5.25
-15	17.4	4.65
-11.25	18.15	6.15
-13.65	18.75	5.25
-16.65	19.5	6
-15.15	20.7	5.25
-19.5	21.3	7.35
-21.15	19.2	6.3
-20.7	19.95	4.95
-25.5	21.3	6.6
-25.65	20.7	4.95
-24.75	19.8	5.1
-27.3	20.55	6.15
-28.95	19.95	4.95
-29.7	19.95	5.25
-31.65	17.25	5.25
-33.75	18.6	5.85
-34.65	17.25	4.95
-37.2	15.3	4.5
-38.4	14.85	6.3
-37.5	13.5	4.65
-39.9	11.4	4.2
-39.9	12.15	5.25
-42	6.9	6.15
-42.45	7.95	6.3
-43.65	5.25	6.75
-43.05	4.95	7.35
-45	3.45	5.85
-44.4	1.35	6.3
-44.4	1.65	5.7
-44.4	-1.35	7.05
-45	-1.5	6.6
-45.9	-2.85	5.25
-44.55	-3.75	5.4
-45.9	-4.35	5.25
-45.75	-9.3	7.35
-45.9	-14.1	4.95
-43.5	-16.65	5.85
-41.4	-20.4	6.75
-41.55	-19.05	5.85
-39.3	-22.95	6.15
-37.2	-23.85	6
-36.75	-25.2	6.15
-36.9	-25.8	6
-34.5	-28.35	6.15
-33.3	-29.1	6.15
-30	-29.1	5.85
-31.65	-28.95	6.3
-28.65	-29.7	6
-27.75	-30.6	6.6
-27.3	-29.85	6.6
-25.8	-29.55	6.15
-22.65	-30.15	6.3
-22.05	-31.5	7.35
-18.45	-30.45	6.3
-19.95	-29.25	7.8
-18.3	-29.55	6.9
-14.7	-27.75	7.5
-9.9	-27.3	7.05
-7.5	-26.4	5.85
-4.2	-22.65	7.05
-0.9	-16.8	7.05
-3.9	-19.5	5.25
-2.25	-18.6	5.1
1.2	-15.75	6
0.15	-14.55	6.3
1.05	-10.5	5.85
2.4	-3.6	6.3
0.75	-3	8.4
0.75	-6.6	5.1
-0.9	6	6
0.45	2.4	4.95
0.3	1.8	6.15
-2.25	8.1	5.85
1.5	1.05	6.6
2.25	-2.7	5.85
1.5	-4.65	5.85
1.2	-5.25	6
0	4.2	5.85
-0.75	4.95	7.35
0.15	9	6
-0.45	7.95	5.7
-2.4	11.85	5.7
-6.15	13.35	5.25
-7.8	15.9	7.65
-9.15	16.05	6
-9	16.65	6.15
-8.7	16.5	8.55
-9	15.9	6.6
-10.65	17.25	6
-12.15	18.75	6.75
-13.05	18.15	5.85
-13.5	18.15	6.6
-3	12	6.15
0	8.85	5.4
-1.8	7.65	5.85
0.15	3.3	6.3
3.9	-2.4	5.25
6.9	-3.6	0.45
10.2	-11.4	-1.65
10.95	-10.95	-2.25
8.7	-8.25	-0.9
10.8	-15.15	-6.15
12	-17.1	-6.6
13.5	-20.55	-9.45
13.5	-27.15	-20.55
13.05	-25.65	-20.1
13.05	-23.25	-17.25
14.25	-25.2	-18.3
14.55	-26.7	-22.8
18	-21.3	-37.8
17.4	-21.15	-38.7
16.2	-23.4	-37.2
16.5	-25.2	-36.3
14.55	-24	-43.05
14.55	-23.25	-47.1
12.45	-22.65	-49.8
9.9	-23.4	-52.8
11.25	-22.95	-53.7
10.5	-21	-56.25
9.75	-20.55	-55.05
10.2	-23.1	-55.35
9.3	-20.55	-57
8.55	-21.3	-57.75
6.45	-19.5	-59.4
5.25	-17.1	-62.1
4.65	-15.75	-64.2
0.75	-10.05	-66.9
2.25	-8.85	-65.85
0.45	-4.35	-67.5
-0.75	4.65	-66.9
-9.3	13.95	-65.85
-14.55	21.75	-62.1
-19.5	26.7	-58.05
-19.95	26.55	-57.9
-21.45	30.45	-52.05
-22.2	37.05	-45.75
-23.4	38.25	-36.6
-22.2	38.7	-37.2
-23.4	38.25	-35.85
-21.75	40.8	-29.4
-22.2	38.7	-28.8
-20.4	40.2	-34.65
-20.4	37.8	-35.1
-22.65	37.8	-32.85
-22.5	38.1	-32.25
-21.45	39	-30.3
-20.7	38.7	-28.05
-22.2	37.8	-27
-21	38.4	-26.1
-21.9	39.45	-24.45
-20.4	39	-22.95
-22.05	39.6	-21.6
-21.45	39	-18.9
-21.9	37.8	-15.6
-19.65	37.5	-14.85
-19.8	36.15	-10.65
-19.65	34.8	-8.55
-21.15	34.8	-9.75
-7.8	23.7	1.8
-9.3	24	1.35
-8.4	18	4.95
-7.95	18	6.3
-9.15	10.2	9.3
-4.2	27	-2.25
0.3	25.65	-10.2
-0.45	26.55	-9
0	29.55	-15
0	29.1	-14.25
1.2	31.2	-20.4
0	31.05	-19.8
1.2	31.95	-22.95
2.25	31.8	-23.85
2.7	30.45	-29.55
4.5	28.65	-28.2
2.25	32.25	-35.55
2.4	30.45	-41.7
4.5	24.45	-49.2
3.15	19.95	-54.15
3.3	20.55	-52.95
5.4	12.6	-57.9
4.2	12.9	-57.45
3.45	6	-62.7
1.5	1.8	-65.4
-10.2	-4.05	-72.9
-14.4	-16.8	-73.65
-16.05	-16.2	-72.75
-15.9	-19.2	-72.6
-18.3	-24.45	-70.65
-19.05	-24.9	-69.45
-24.3	-39.15	-63.15
-22.8	-43.05	-61.35
-27.9	-46.05	-54.6
-28.95	-46.05	-53.85
-28.95	-48	-53.85
-31.8	-49.35	-47.7
-30.45	-48.75	-48
-32.25	-52.05	-37.8
-31.2	-52.65	-38.7
-37.05	-48.6	-32.7
-38.7	-50.25	-33.3
-36	-50.85	-26.1
-32.25	-48.15	-13.5
-28.5	-45	-6.9
-29.4	-44.4	-7.8
-54.9	-34.8	-21.15
-55.8	-34.95	-19.5
-53.25	-39.6	-28.95
-49.65	-43.35	-39.15
-49.8	-42.75	-39
-47.25	-41.55	-44.1
-49.05	-42	-24.6
-54.75	-34.2	-19.05
-54	-31.8	-10.65
-53.25	-30.6	-9.9
-49.8	-28.65	-5.85
-48.15	-22.65	2.7
-45.45	-18.45	4.2
-44.25	-19.05	4.35
-42.15	-14.55	8.55
-40.05	-15.45	7.35
-45.9	-12.15	4.5
-44.4	-11.85	7.05
-45.45	-9.9	5.25
-44.25	-10.8	6.6
-43.95	-12.15	7.05
-44.55	-7.35	7.95
-43.8	-8.1	7.65
-39.45	-6.3	8.55
-39.9	-6.3	10.8
-38.25	-3.75	11.4
-36.3	-3.75	10.65
-30.15	2.1	11.55
-30.15	1.35	13.05
-29.55	2.7	10.95
-40.2	4.05	10.35
-27.9	10.95	9
-27.9	10.95	10.35
-21.15	14.85	9.3
-23.4	16.05	9.3
-22.95	14.1	9
-27.15	12.6	10.35
-27.15	10.95	10.05
-19.2	19.2	8.25
-20.7	18.45	6.75
-18.45	18.75	7.5
-12.75	14.25	7.65];

%% ----------------  [Calibrated Norm Data]  ---------------- %%

C1 = [-0.6162181547	0.7419769618	0.2640934949
-0.6350819758	0.7545528425	0.2955331966
-0.6413699161	0.1257588071	0.4778834669
-0.7042493196	-1.119253383	0.2766693756
-0.71053726	-1.163268965	0.2640934949
-0.6413699161	-1.678880075	-0.04401558248
-0.6790975582	-1.942973569	-0.3458367195
-0.7545528425	-1.905245927	-0.3961402423
-0.6979613793	-2.175627362	-1.056373979
-0.6476578565	-2.207067064	-1.081525741
-0.6790975582	-2.156763541	-1.452514222
-0.6916734389	-2.213355005	-1.41478658
-0.6099302143	-2.087596198	-2.12532384
-0.6979613793	-1.798350941	-2.458584678
-0.71053726	-1.766911239	-2.439720857
-0.71053726	-1.377058938	-2.779269636
-0.6790975582	-1.848654464	-2.458584678
-0.5533387512	-2.043580615	-2.13161178
-0.5030352283	-2.087596198	-1.804638882
-0.5093231687	-2.225930885	-1.452514222
-0.4590196458	-2.175627362	-1.377058938
-0.5470508108	-2.163051482	-1.263876011
-0.5722025722	-1.031222218	-2.949044026
-0.5784905126	-0.9746307549	-2.974195787
-0.6413699161	-0.4841714073	-3.099954595
-0.6287940354	-0.2075020317	-3.081090773
-0.6665216775	0.08803116496	-3.087378714
-0.6350819758	0.01886382106	-3.055939012
-0.6099302143	0.09431910531	-3.068514893
-0.7294010811	0.496747288	-2.999347549
-0.6728096179	0.5030352283	-2.974195787
-0.6916734389	0.9117513513	-2.728966114
-0.7545528425	1.106677502	-2.603207307
-0.6979613793	1.112965443	-2.458584678
-0.7419769618	1.112965443	-2.596919366
-0.6665216775	1.263876011	-2.30138617
-0.6162181547	1.622288611	-1.546833327
-0.5847784529	1.571985088	-1.502817745
-0.6287940354	1.660016253	-1.043798099
-0.5722025722	1.471378043	-0.3898523019
-0.6099302143	1.41478658	-0.4275799441
-0.6287940354	1.169556906	-0.05659146319
-0.5973543336	1.41478658	-0.3332608388
-0.6602337372	1.188420727	-0.02515176142
-0.6099302143	0.798568425	0.2578055545
-0.6476578565	0.7734166635	0.2515176142
-0.6099302143	0.7608407828	0.2263658527
-0.3458367195	0.7797046039	0.1634864492
-0.2955331966	0.7482649021	0.213789972
-0.3206849581	0.7042493196	0.2389417335
0.1697743896	0.7797046039	-0.1634864492
0.1697743896	0.7797046039	-0.1509105685
-0.5218990494	0.7545528425	0.2389417335
-0.301821137	0.7231131407	0.2200779124
0.05030352283	0.7859925442	-0.006287940354
0.3143970177	0.7797046039	-0.2766693756
0.2640934949	0.7797046039	-0.2578055545
0.2640934949	0.798568425	-0.2578055545
0.5218990494	0.817432246	-0.6979613793
0.6099302143	0.7168252004	-1.276451892
0.6665216775	0.7419769618	-1.282739832
0.6287940354	0.7482649021	-1.307891594
0.5407628704	0.7545528425	-0.9306151724
0.6162181547	0.6728096179	-0.9431910531
0.4904593476	0.7231131407	-0.5910663933
0.3772764212	0.6979613793	-0.3961402423
0.3961402423	0.7734166635	-0.4338678844
0.2703814352	0.8048563653	-0.2829573159
0.2263658527	0.7734166635	-0.1131829264
0.1760623299	0.7734166635	-0.1571985088
0.09431910531	0.7168252004	-0.07545528425
0.06287940354	0.7608407828	-0.02515176142
-0.01886382106	0.6916734389	0.03772764212
-0.1383346878	0.7168252004	0.1509105685
0.6665216775	0.7419769618	-1.515393625
0.3961402423	0.7042493196	-2.13161178
0.6476578565	0.5407628704	-1.810926822
0.5973543336	0.6790975582	-1.880094166
0.5784905126	0.6979613793	-1.95554945
0.5659146319	0.6979613793	-2.018428854
0.4527317055	0.6350819758	-2.12532384
0.3772764212	0.6476578565	-2.30767411
0.3521246598	0.6413699161	-2.288810289
0.2326537931	0.6979613793	-2.452296738
0.2200779124	0.6476578565	-2.433432917
0.1446226281	0.6099302143	-2.502600261
0.1760623299	0.6602337372	-2.546615843
-0.1006070457	0.5910663933	-2.691238472
-0.1634864492	0.5910663933	-2.747829935
-0.1760623299	0.5596266915	-2.84214904
-0.2640934949	0.5847784529	-2.760405815
-0.2955331966	0.5847784529	-2.8358611
-0.4841714073	0.7168252004	-2.84843698
-0.5847784529	0.622506095	-2.810709338
-0.4778834669	0.6728096179	-2.873588742
-0.5722025722	0.7231131407	-2.829573159
-0.6476578565	0.6728096179	-2.861012861
-0.6350819758	0.6413699161	-2.861012861
-0.6916734389	0.6665216775	-2.898740503
-0.8928875303	0.5847784529	-2.942756086
-0.8488719478	0.6162181547	-2.898740503
-0.8928875303	0.5847784529	-2.942756086
-0.8865995899	0.5784905126	-2.936468145
-1.024934278	0.6099302143	-2.967907847
-1.075237801	0.622506095	-3.030787251
-1.207284548	0.6162181547	-2.961619907
-1.289027773	0.5344749301	-2.898740503
-1.207284548	0.4841714073	-2.961619907
-1.41478658	0.5030352283	-2.8358611
-1.42107452	0.4778834669	-2.873588742
-1.616000671	0.5659146319	-2.760405815
-1.496529804	0.5407628704	-2.861012861
-1.766911239	0.5281869897	-2.67237465
-1.823502703	0.5218990494	-2.697526412
-1.760623299	0.4715955265	-2.678662591
-1.810926822	0.4778834669	-2.716390233
-2.119035899	0.4715955265	-2.540327903
-2.276234408	0.4841714073	-2.200779124
-2.30138617	0.622506095	-2.150475601
-2.376841454	0.5910663933	-1.873806225
-2.452296738	0.5973543336	-1.804638882
-2.458584678	0.622506095	-1.641152432
-2.48373644	0.5973543336	-1.571985088
-2.464872619	0.5973543336	-1.540545387
-2.389417335	0.5973543336	-1.647440373
-2.464872619	0.5973543336	-1.402210699
-2.433432917	0.6350819758	-1.031222218
-2.420857036	0.6476578565	-1.012358397
-2.471160559	0.622506095	-1.112965443
-2.521464082	0.6728096179	-1.112965443
-2.427144977	0.6413699161	-1.06894986
-2.420857036	0.6665216775	-1.06266192
-2.452296738	0.6476578565	-0.8425840074
-2.357977633	0.6350819758	-0.6916734389
-2.332825871	0.7042493196	-0.622506095
-2.207067064	0.6728096179	-0.5596266915
-2.238506766	0.6916734389	-0.4653075862
-2.169339422	0.7294010811	-0.3961402423
-2.175627362	0.6602337372	-0.3584126002
-2.087596198	0.6162181547	-0.3521246598
-2.018428854	0.7042493196	-0.2075020317
-1.999565033	0.6916734389	-0.2515176142
-1.905245927	0.6728096179	-0.1760623299
-1.94926151	0.7168252004	-0.1634864492
-1.968125331	0.7231131407	-0.1886382106
-1.810926822	0.6413699161	-0.09431910531
-1.735471538	0.6728096179	-0.03772764212
-1.678880075	0.6665216775	0
-1.634864492	0.7482649021	0.08803116496
-1.634864492	0.6979613793	0.1194708667
-1.452514222	0.7042493196	0.09431910531
-1.490241864	0.7168252004	0.07545528425
-1.364483057	0.6476578565	0.1634864492
-1.351907176	0.7482649021	0.1509105685
-1.175844846	0.7168252004	0.2452296738
-1.056373979	0.7419769618	0.2515176142
-0.9872066356	0.7294010811	0.2578055545
-0.9809186952	0.6728096179	0.1886382106
-0.8488719478	0.7294010811	0.2263658527
-0.7734166635	0.7419769618	0.2075020317
-0.6790975582	0.7231131407	0.2200779124
-0.6287940354	0.7294010811	0.194926151
-0.4715955265	0.7608407828	0.2578055545
-0.5722025722	0.7859925442	0.2200779124
-0.6979613793	0.817432246	0.2515176142
-0.6350819758	0.8677357689	0.2200779124
-0.817432246	0.8928875303	0.3081090773
-0.8865995899	0.8048563653	0.2640934949
-0.8677357689	0.8362960671	0.2075020317
-1.06894986	0.8928875303	0.2766693756
-1.075237801	0.8677357689	0.2075020317
-1.037510158	0.8300081267	0.213789972
-1.144405144	0.8614478285	0.2578055545
-1.213572488	0.8362960671	0.2075020317
-1.24501219	0.8362960671	0.2200779124
-1.326755415	0.7231131407	0.2200779124
-1.41478658	0.7797046039	0.2452296738
-1.452514222	0.7231131407	0.2075020317
-1.559409208	0.6413699161	0.1886382106
-1.609712731	0.622506095	0.2640934949
-1.571985088	0.5659146319	0.194926151
-1.672592134	0.4778834669	0.1760623299
-1.672592134	0.5093231687	0.2200779124
-1.760623299	0.2892452563	0.2578055545
-1.77948712	0.3332608388	0.2640934949
-1.829790643	0.2200779124	0.2829573159
-1.804638882	0.2075020317	0.3081090773
-1.886382106	0.1446226281	0.2452296738
-1.861230345	0.05659146319	0.2640934949
-1.861230345	0.06916734389	0.2389417335
-1.861230345	-0.05659146319	0.2955331966
-1.886382106	-0.06287940354	0.2766693756
-1.924109748	-0.1194708667	0.2200779124
-1.867518285	-0.1571985088	0.2263658527
-1.924109748	-0.1823502703	0.2200779124
-1.917821808	-0.3898523019	0.3081090773
-1.924109748	-0.5910663933	0.2075020317
-1.823502703	-0.6979613793	0.2452296738
-1.735471538	-0.8551598881	0.2829573159
-1.741759478	-0.798568425	0.2452296738
-1.647440373	-0.9620548742	0.2578055545
-1.559409208	-0.9997825163	0.2515176142
-1.540545387	-1.056373979	0.2578055545
-1.546833327	-1.081525741	0.2515176142
-1.446226281	-1.188420727	0.2578055545
-1.395922759	-1.219860429	0.2578055545
-1.257588071	-1.219860429	0.2452296738
-1.326755415	-1.213572488	0.2640934949
-1.200996608	-1.24501219	0.2515176142
-1.163268965	-1.282739832	0.2766693756
-1.144405144	-1.25130013	0.2766693756
-1.081525741	-1.23872425	0.2578055545
-0.9494789935	-1.263876011	0.2640934949
-0.924327232	-1.320467474	0.3081090773
-0.7734166635	-1.276451892	0.2640934949
-0.8362960671	-1.226148369	0.3269728984
-0.7671287232	-1.23872425	0.2892452563
-0.6162181547	-1.163268965	0.3143970177
-0.4150040634	-1.144405144	0.2955331966
-0.3143970177	-1.106677502	0.2452296738
-0.1760623299	-0.9494789935	0.2955331966
-0.03772764212	-0.7042493196	0.2955331966
-0.1634864492	-0.817432246	0.2200779124
-0.09431910531	-0.7797046039	0.213789972
0.05030352283	-0.6602337372	0.2515176142
0.006287940354	-0.6099302143	0.2640934949
0.04401558248	-0.4401558248	0.2452296738
0.1006070457	-0.1509105685	0.2640934949
0.03143970177	-0.1257588071	0.3521246598
0.03143970177	-0.2766693756	0.213789972
-0.03772764212	0.2515176142	0.2515176142
0.01886382106	0.1006070457	0.2075020317
0.01257588071	0.07545528425	0.2578055545
-0.09431910531	0.3395487791	0.2452296738
0.06287940354	0.04401558248	0.2766693756
0.09431910531	-0.1131829264	0.2452296738
0.06287940354	-0.194926151	0.2452296738
0.05030352283	-0.2200779124	0.2515176142
0	0.1760623299	0.2452296738
-0.03143970177	0.2075020317	0.3081090773
0.006287940354	0.3772764212	0.2515176142
-0.01886382106	0.3332608388	0.2389417335
-0.1006070457	0.496747288	0.2389417335
-0.2578055545	0.5596266915	0.2200779124
-0.3269728984	0.6665216775	0.3206849581
-0.3835643616	0.6728096179	0.2515176142
-0.3772764212	0.6979613793	0.2578055545
-0.3647005405	0.6916734389	0.3584126002
-0.3772764212	0.6665216775	0.2766693756
-0.4464437651	0.7231131407	0.2515176142
-0.5093231687	0.7859925442	0.2829573159
-0.5470508108	0.7608407828	0.2452296738
-0.5659146319	0.7608407828	0.2766693756
-0.1257588071	0.5030352283	0.2578055545
0	0.3709884809	0.2263658527
-0.07545528425	0.3206849581	0.2452296738
0.006287940354	0.1383346878	0.2640934949
0.1634864492	-0.1006070457	0.2200779124
0.2892452563	-0.1509105685	0.01886382106
0.4275799441	-0.4778834669	-0.06916734389
0.4590196458	-0.4590196458	-0.09431910531
0.3647005405	-0.3458367195	-0.03772764212
0.4527317055	-0.6350819758	-0.2578055545
0.5030352283	-0.7168252004	-0.2766693756
0.5659146319	-0.8614478285	-0.3961402423
0.5659146319	-1.138117204	-0.8614478285
0.5470508108	-1.075237801	-0.8425840074
0.5470508108	-0.9746307549	-0.7231131407
0.5973543336	-1.056373979	-0.7671287232
0.6099302143	-1.119253383	-0.9557669338
0.7545528425	-0.8928875303	-1.584560969
0.7294010811	-0.8865995899	-1.622288611
0.6790975582	-0.9809186952	-1.559409208
0.6916734389	-1.056373979	-1.521681566
0.6099302143	-1.006070457	-1.804638882
0.6099302143	-0.9746307549	-1.974413271
0.5218990494	-0.9494789935	-2.087596198
0.4150040634	-0.9809186952	-2.213355005
0.4715955265	-0.9620548742	-2.251082647
0.4401558248	-0.8803116496	-2.357977633
0.408716123	-0.8614478285	-2.30767411
0.4275799441	-0.9683428145	-2.320249991
0.3898523019	-0.8614478285	-2.389417335
0.3584126002	-0.8928875303	-2.420857036
0.2703814352	-0.817432246	-2.49002438
0.2200779124	-0.7168252004	-2.603207307
0.194926151	-0.6602337372	-2.691238472
0.03143970177	-0.4212920037	-2.804421398
0.09431910531	-0.3709884809	-2.760405815
0.01886382106	-0.1823502703	-2.829573159
-0.03143970177	0.194926151	-2.804421398
-0.3898523019	0.5847784529	-2.760405815
-0.6099302143	0.9117513513	-2.603207307
-0.817432246	1.119253383	-2.433432917
-0.8362960671	1.112965443	-2.427144977
-0.8991754706	1.276451892	-2.181915303
-0.9306151724	1.553121267	-1.917821808
-0.9809186952	1.60342479	-1.534257446
-0.9306151724	1.622288611	-1.559409208
-0.9809186952	1.60342479	-1.502817745
-0.9117513513	1.710319776	-1.232436309
-0.9306151724	1.622288611	-1.207284548
-0.8551598881	1.685168015	-1.452514222
-0.8551598881	1.584560969	-1.471378043
-0.9494789935	1.584560969	-1.377058938
-0.9431910531	1.59713685	-1.351907176
-0.8991754706	1.634864492	-1.270163952
-0.8677357689	1.622288611	-1.175844846
-0.9306151724	1.584560969	-1.131829264
-0.8803116496	1.609712731	-1.094101622
-0.9180392917	1.653728313	-1.024934278
-0.8551598881	1.634864492	-0.9620548742
-0.924327232	1.660016253	-0.905463411
-0.8991754706	1.634864492	-0.7922804846
-0.9180392917	1.584560969	-0.6539457968
-0.8237201864	1.571985088	-0.622506095
-0.8300081267	1.515393625	-0.4464437651
-0.8237201864	1.458802162	-0.3584126002
-0.8865995899	1.458802162	-0.408716123
-0.3269728984	0.9934945759	0.07545528425
-0.3898523019	1.006070457	0.05659146319
-0.3521246598	0.7545528425	0.2075020317
-0.3332608388	0.7545528425	0.2640934949
-0.3835643616	0.4275799441	0.3898523019
-0.1760623299	1.131829264	-0.09431910531
0.01257588071	1.075237801	-0.4275799441
-0.01886382106	1.112965443	-0.3772764212
0	1.23872425	-0.6287940354
0	1.219860429	-0.5973543336
0.05030352283	1.307891594	-0.8551598881
0	1.301603653	-0.8300081267
0.05030352283	1.339331295	-0.9620548742
0.09431910531	1.333043355	-0.9997825163
0.1131829264	1.276451892	-1.23872425
0.1886382106	1.200996608	-1.182132787
0.09431910531	1.351907176	-1.490241864
0.1006070457	1.276451892	-1.748047418
0.1886382106	1.024934278	-2.062444436
0.1320467474	0.8362960671	-2.269946468
0.1383346878	0.8614478285	-2.219642945
0.2263658527	0.5281869897	-2.427144977
0.1760623299	0.5407628704	-2.408281156
0.1446226281	0.2515176142	-2.628359068
0.06287940354	0.07545528425	-2.741541994
-0.4275799441	-0.1697743896	-3.055939012
-0.603642274	-0.7042493196	-3.087378714
-0.6728096179	-0.6790975582	-3.049651072
-0.6665216775	-0.8048563653	-3.043363131
-0.7671287232	-1.024934278	-2.961619907
-0.798568425	-1.043798099	-2.911316384
-1.018646337	-1.641152432	-2.647222889
-0.9557669338	-1.804638882	-2.571767605
-1.169556906	-1.930397689	-2.288810289
-1.213572488	-1.930397689	-2.257370587
-1.213572488	-2.012140913	-2.257370587
-1.333043355	-2.068732376	-1.999565033
-1.276451892	-2.043580615	-2.012140913
-1.351907176	-2.181915303	-1.584560969
-1.307891594	-2.207067064	-1.622288611
-1.553121267	-2.037292675	-1.370770997
-1.622288611	-2.106460019	-1.395922759
-1.509105685	-2.13161178	-1.094101622
-1.351907176	-2.018428854	-0.5659146319
-1.194708667	-1.886382106	-0.2892452563
-1.232436309	-1.861230345	-0.3269728984
-2.30138617	-1.458802162	-0.8865995899
-2.339113812	-1.465090102	-0.817432246
-2.232218826	-1.660016253	-1.213572488
-2.081308257	-1.817214762	-1.641152432
-2.087596198	-1.792063001	-1.634864492
-1.980701212	-1.741759478	-1.848654464
-2.056156496	-1.760623299	-1.031222218
-2.295098229	-1.433650401	-0.798568425
-2.263658527	-1.333043355	-0.4464437651
-2.232218826	-1.282739832	-0.4150040634
-2.087596198	-1.200996608	-0.2452296738
-2.018428854	-0.9494789935	0.1131829264
-1.905245927	-0.7734166635	0.1760623299
-1.854942404	-0.798568425	0.1823502703
-1.766911239	-0.6099302143	0.3584126002
-1.678880075	-0.6476578565	0.3081090773
-1.924109748	-0.5093231687	0.1886382106
-1.861230345	-0.496747288	0.2955331966
-1.905245927	-0.4150040634	0.2200779124
-1.854942404	-0.4527317055	0.2766693756
-1.842366524	-0.5093231687	0.2955331966
-1.867518285	-0.3081090773	0.3332608388
-1.836078583	-0.3395487791	0.3206849581
-1.653728313	-0.2640934949	0.3584126002
-1.672592134	-0.2640934949	0.4527317055
-1.60342479	-0.1571985088	0.4778834669
-1.521681566	-0.1571985088	0.4464437651
-1.263876011	0.08803116496	0.4841714073
-1.263876011	0.05659146319	0.5470508108
-1.23872425	0.1131829264	0.4590196458
-1.685168015	0.1697743896	0.4338678844
-1.169556906	0.4590196458	0.3772764212
-1.169556906	0.4590196458	0.4338678844
-0.8865995899	0.622506095	0.3898523019
-0.9809186952	0.6728096179	0.3898523019
-0.9620548742	0.5910663933	0.3772764212
-1.138117204	0.5281869897	0.4338678844
-1.138117204	0.4590196458	0.4212920037
-0.8048563653	0.8048563653	0.3458367195
-0.8677357689	0.7734166635	0.2829573159
-0.7734166635	0.7859925442	0.3143970177
-0.5344749301	0.5973543336	0.3206849581];

%% ----------------  [Magneto Data]  ---------------- %%

A = [0.023431 , -0.000513 , -0.000139;
    -0.000513 , 0.021650 , -0.000275;
    -0.000139 , -0.000275 , 0.022589];

B = [-22.141157 , -6.868126 , -30.821610];

D = (A * (C - B)')';

MagD = D(:,1).^2 + D(:,2).^2 + D(:,3).^2;

%% --------------------  [Plot]  -------------------- %%

figure;
hold on;
grid on;
p1 = plot3(C1(:,1),C1(:,2),C1(:,3),'.','MarkerSize', 15);
p2 = plot3(D(:,1),D(:,2),D(:,3),'.','MarkerSize', 15);
ellipsoid(C1(:,1),C1(:,2),C1(:,3),[0 0.4470 0.7410],0.1);
ellipsoid(D(:,1),D(:,2),D(:,3),[0.8500 0.3250 0.0980],0.1);
legend('Uncalibrated Magnetometer Data','Calibrated Magnetometer Data');
xlabel('X'), ylabel('Y'), zlabel('Z');
title('Magnetometer Data 3D Scatterplot');
view(45,10);
axis vis3d;

function ellipsoid(x,y,z,color,trans)

% Matlab Add-on for Ellipsoid Fit by Yury %
%<https://www.mathworks.com/matlabcentral/fileexchange/24693-ellipsoid-fit>
[ center, radii, evec, v, chi ] = ellipsoid_fit( [ x y z ], '' );

size_min = min( [ x y z ] );
size_max = max( [ x y z ] );

steps = 100;
step = ( size_max - size_min ) / steps;

[ x, y, z ] = meshgrid( linspace( size_min(1) - step(1), size_max(1) + step(1), steps ), linspace( size_min(2) - step(2), size_max(2) + step(2), steps ), linspace( size_min(3) - step(3), size_max(3) + step(3), steps ) );

E = v(1) *x.*x +   v(2) * y.*y + v(3) * z.*z + ...
          2*v(4) *x.*y + 2*v(5)*x.*z + 2*v(6) * y.*z + ...
          2*v(7) *x    + 2*v(8)*y    + 2*v(9) * z;
e = patch( isosurface( x, y, z, E, -v(10) ) );
set( e, 'FaceColor',color, 'EdgeColor', 'none','FaceAlpha',trans);
end


